{"ast":null,"code":"import _classCallCheck from \"/Users/ricky/Desktop/PROJECTS/mern-plaid/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/ricky/Desktop/PROJECTS/mern-plaid/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/ricky/Desktop/PROJECTS/mern-plaid/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/ricky/Desktop/PROJECTS/mern-plaid/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/ricky/Desktop/PROJECTS/mern-plaid/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/ricky/Desktop/PROJECTS/mern-plaid/client/src/components/dashboard/Dashboard.js\";\nimport React, { Component } from \"react\";\nimport PlaidLinkButton from \"react-plaid-link-button\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport axios from \"axios\";\nimport { logoutUser } from \"../../actions/authActions\";\nimport { getAccounts, addAccount } from \"../../actions/accountActions\";\nimport Accounts from \"./Accounts\";\nimport Spinner from \"./Spinner\";\n\nvar Dashboard = /*#__PURE__*/function (_Component) {\n  _inherits(Dashboard, _Component);\n\n  function Dashboard(props) {\n    var _this;\n\n    _classCallCheck(this, Dashboard);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Dashboard).call(this, props));\n\n    _this.setLinkToken = function (response) {\n      var data = response.data,\n          status = response.status;\n\n      if (status === 200) {\n        _this.setState({\n          plaidLinkToken: data.link_token,\n          loadingLinkToken: false\n        });\n      } else {\n        // error\n        console.error(response);\n      }\n    };\n\n    _this.onLogoutClick = function (e) {\n      e.preventDefault();\n\n      _this.props.logoutUser();\n    };\n\n    _this.handleOnSuccess = function (token, metadata) {\n      var plaidData = {\n        public_token: token,\n        metadata: metadata\n      };\n\n      _this.props.addAccount(plaidData);\n    };\n\n    _this.state = {\n      plaidLinkToken: null,\n      loadingLinkToken: true\n    };\n    return _this;\n  }\n\n  _createClass(Dashboard, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.props.getAccounts();\n      axios.post(\"http://localhost:5000/api/plaid/api/create_link_token\").then(this.setLinkToken).catch(function (err) {\n        return console.log(err);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var user = this.props.auth.user;\n      var _this$props$plaid = this.props.plaid,\n          accounts = _this$props$plaid.accounts,\n          accountsLoading = _this$props$plaid.accountsLoading;\n      var dashboardContent;\n\n      if (accounts === null || accountsLoading || this.state.loadingLinkToken) {\n        dashboardContent = /*#__PURE__*/React.createElement(Spinner, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 55,\n            columnNumber: 26\n          }\n        });\n        dashboardContent = /*#__PURE__*/React.createElement(\"p\", {\n          className: \"center-align\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 56,\n            columnNumber: 26\n          }\n        }, \"Loading...\");\n      } else if (accounts.length > 0) {\n        // User has accounts linked\n        dashboardContent = /*#__PURE__*/React.createElement(Accounts, {\n          user: user,\n          accounts: accounts,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 59,\n            columnNumber: 26\n          }\n        });\n      } else {\n        // User has no accounts linked\n        dashboardContent = /*#__PURE__*/React.createElement(\"div\", {\n          className: \"row\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 63,\n            columnNumber: 9\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"col s12 center-align\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 11\n          }\n        }, /*#__PURE__*/React.createElement(\"h4\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 13\n          }\n        }, /*#__PURE__*/React.createElement(\"b\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 66,\n            columnNumber: 15\n          }\n        }, \"Welcome,\"), \" \", user.name.split(\" \")[0]), /*#__PURE__*/React.createElement(\"p\", {\n          className: \"flow-text grey-text text-darken-1\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 13\n          }\n        }, \"To get started, link your first bank account below\"), /*#__PURE__*/React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 13\n          }\n        }, /*#__PURE__*/React.createElement(PlaidLinkButton, {\n          buttonProps: {\n            className: \"btn btn-large waves-effect waves-light hoverable blue accent-3 main-btn\"\n          },\n          plaidLinkProps: {\n            clientName: \"BankConnector\",\n            key: \"\",\n            token: this.state.plaidLinkToken,\n            env: \"sandbox\",\n            product: [\"transactions\"],\n            webhook: \"https://webhook.site/c9cdcac9-8194-41b7-9369-0f725a898281\",\n            onSuccess: this.handleOnSuccess\n          },\n          onScriptLoad: function onScriptLoad() {\n            return _this2.setState({\n              loaded: true\n            });\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 72,\n            columnNumber: 15\n          }\n        }, \"Link Account\")), /*#__PURE__*/React.createElement(\"button\", {\n          onClick: this.onLogoutClick,\n          className: \"btn btn-large waves-effect waves-light hoverable red accent-3 main-btn\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 13\n          }\n        }, \"Logout\")));\n      }\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"container\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 12\n        }\n      }, dashboardContent);\n    }\n  }]);\n\n  return Dashboard;\n}(Component);\n\nDashboard.propTypes = {\n  logoutUser: PropTypes.func.isRequired,\n  getAccounts: PropTypes.func.isRequired,\n  addAccount: PropTypes.func.isRequired,\n  auth: PropTypes.object.isRequired,\n  plaid: PropTypes.object.isRequired\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    auth: state.auth,\n    plaid: state.plaid\n  };\n};\n\nexport default connect(mapStateToProps, {\n  logoutUser: logoutUser,\n  getAccounts: getAccounts,\n  addAccount: addAccount\n})(Dashboard);","map":{"version":3,"sources":["/Users/ricky/Desktop/PROJECTS/mern-plaid/client/src/components/dashboard/Dashboard.js"],"names":["React","Component","PlaidLinkButton","PropTypes","connect","axios","logoutUser","getAccounts","addAccount","Accounts","Spinner","Dashboard","props","setLinkToken","response","data","status","setState","plaidLinkToken","link_token","loadingLinkToken","console","error","onLogoutClick","e","preventDefault","handleOnSuccess","token","metadata","plaidData","public_token","state","post","then","catch","err","log","user","auth","plaid","accounts","accountsLoading","dashboardContent","length","name","split","className","clientName","key","env","product","webhook","onSuccess","loaded","propTypes","func","isRequired","object","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport PlaidLinkButton from \"react-plaid-link-button\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport axios from \"axios\";\nimport { logoutUser } from \"../../actions/authActions\";\nimport { getAccounts, addAccount } from \"../../actions/accountActions\";\nimport Accounts from \"./Accounts\";\nimport Spinner from \"./Spinner\";\n\nclass Dashboard extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      plaidLinkToken: null,\n      loadingLinkToken: true\n    }\n  }\n  componentDidMount() {\n    this.props.getAccounts();\n\n    axios\n      .post(\"http://localhost:5000/api/plaid/api/create_link_token\")\n      .then(this.setLinkToken)\n      .catch(err => console.log(err));\n  }\n  setLinkToken = response => {\n    const { data, status } = response;\n    if(status === 200) {\n      this.setState({ plaidLinkToken: data.link_token, loadingLinkToken: false })\n    } else {\n      // error\n      console.error(response)\n    }\n  }\n  // Logout\n  onLogoutClick = e => {\n    e.preventDefault();\n    this.props.logoutUser();\n  };\n  // Add account\n  handleOnSuccess = (token, metadata) => {\n    const plaidData = {\n      public_token: token,\n      metadata: metadata\n    };\n    this.props.addAccount(plaidData);\n  };\n  render() {\n    const { user } = this.props.auth;\n    const { accounts, accountsLoading } = this.props.plaid;\n    let dashboardContent;\n    if (accounts === null || accountsLoading || this.state.loadingLinkToken) {\n      dashboardContent = <Spinner />;\n      dashboardContent = <p className=\"center-align\">Loading...</p>;\n    } else if (accounts.length > 0) {\n      // User has accounts linked\n      dashboardContent = <Accounts user={user} accounts={accounts} />;\n    } else {\n      // User has no accounts linked\n      dashboardContent = (\n        <div className=\"row\">\n          <div className=\"col s12 center-align\">\n            <h4>\n              <b>Welcome,</b> {user.name.split(\" \")[0]}\n            </h4>\n            <p className=\"flow-text grey-text text-darken-1\">\n              To get started, link your first bank account below\n            </p>\n            <div>\n              <PlaidLinkButton\n                buttonProps={{\n                  className:\n                    \"btn btn-large waves-effect waves-light hoverable blue accent-3 main-btn\"\n                }}\n                plaidLinkProps={{\n                  clientName: \"BankConnector\",\n                  key: \"\",\n                  token: this.state.plaidLinkToken,\n                  env: \"sandbox\",\n                  product: [\"transactions\"],\n                  webhook: \"https://webhook.site/c9cdcac9-8194-41b7-9369-0f725a898281\",\n                  onSuccess: this.handleOnSuccess\n                }}\n                onScriptLoad={() => this.setState({ loaded: true })}\n              >\n                Link Account\n              </PlaidLinkButton>\n            </div>\n            <button\n              onClick={this.onLogoutClick}\n              className=\"btn btn-large waves-effect waves-light hoverable red accent-3 main-btn\"\n            >\n              Logout\n            </button>\n          </div>\n        </div>\n      );\n    }\n    return <div className=\"container\">{dashboardContent}</div>;\n  }\n}\nDashboard.propTypes = {\n  logoutUser: PropTypes.func.isRequired,\n  getAccounts: PropTypes.func.isRequired,\n  addAccount: PropTypes.func.isRequired,\n  auth: PropTypes.object.isRequired,\n  plaid: PropTypes.object.isRequired\n};\nconst mapStateToProps = state => ({\n  auth: state.auth,\n  plaid: state.plaid\n});\nexport default connect(\n  mapStateToProps,\n  { logoutUser, getAccounts, addAccount }\n)(Dashboard);\n"]},"metadata":{},"sourceType":"module"}