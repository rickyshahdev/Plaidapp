{"ast":null,"code":"import _regeneratorRuntime from \"/Users/ricky/Desktop/PROJECTS/mern-plaid/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/ricky/Desktop/PROJECTS/mern-plaid/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/ricky/Desktop/PROJECTS/mern-plaid/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/ricky/Desktop/PROJECTS/mern-plaid/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/ricky/Desktop/PROJECTS/mern-plaid/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/ricky/Desktop/PROJECTS/mern-plaid/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/ricky/Desktop/PROJECTS/mern-plaid/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/ricky/Desktop/PROJECTS/mern-plaid/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/ricky/Desktop/PROJECTS/mern-plaid/client/src/components/dashboard/Accounts.js\";\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport PlaidLinkButton from \"react-plaid-link-button\";\nimport Plaid from \"plaid\";\nimport $ from \"jquery\";\nimport { connect } from \"react-redux\";\nimport { getTransactions, addAccount, deleteAccount } from \"../../actions/accountActions\";\nimport { logoutUser } from \"../../actions/authActions\";\nimport MaterialTable from \"material-table\"; // https://mbrn.github.io/material-table/#/\n\nvar Accounts = /*#__PURE__*/function (_Component) {\n  _inherits(Accounts, _Component);\n\n  function Accounts() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Accounts);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Accounts)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this.handleOnSuccess = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(token, metadata) {\n        var accounts, plaidData;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                accounts = _this.props.accounts;\n                plaidData = {\n                  public_token: token,\n                  metadata: metadata,\n                  accounts: accounts\n                }; // send public_token to server\n\n                _this.props.addAccount(plaidData);\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.onDeleteClick = function (id) {\n      var accounts = _this.props.accounts;\n      var accountData = {\n        id: id,\n        accounts: accounts\n      };\n\n      _this.props.deleteAccount(accountData);\n    };\n\n    _this.onLogoutClick = function (e) {\n      e.preventDefault();\n\n      _this.props.logoutUser();\n    };\n\n    _this.render = function () {\n      var plaidData = /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  _context2.t0 = Plaid;\n                  _context2.next = 3;\n                  return $.post('/create_link_token');\n\n                case 3:\n                  _context2.t1 = _context2.sent.link_token;\n\n                  _context2.t2 = function onSuccess(public_token, metadata) {\n                    // Send the public_token to your app server.\n                    $.post('/get_access_token', {\n                      public_token: public_token\n                    });\n                  };\n\n                  _context2.t3 = function onExit(err, metadata) {// Optionally capture when your user exited the Link flow.\n                    // Storing this information can be helpful for support.\n                  };\n\n                  _context2.t4 = function onEvent(eventName, metadata) {// Optionally capture Link flow events, streamed through\n                    // this callback as your users connect an Item to Plaid.\n                  };\n\n                  _context2.t5 = {\n                    token: _context2.t1,\n                    onSuccess: _context2.t2,\n                    onExit: _context2.t3,\n                    onEvent: _context2.t4\n                  };\n\n                  _context2.t0.create.call(_context2.t0, _context2.t5);\n\n                case 9:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2);\n        }));\n\n        return function plaidData() {\n          return _ref2.apply(this, arguments);\n        };\n      }();\n\n      var _this$props = _this.props,\n          user = _this$props.user,\n          accounts = _this$props.accounts;\n      var _this$props$plaid = _this.props.plaid,\n          transactions = _this$props$plaid.transactions,\n          transactionsLoading = _this$props$plaid.transactionsLoading;\n      var accountItems = accounts.map(function (account) {\n        return /*#__PURE__*/React.createElement(\"li\", {\n          key: account._id,\n          style: {\n            marginTop: \"1rem\"\n          },\n          __self: _assertThisInitialized(_assertThisInitialized(_this)),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 7\n          }\n        }, /*#__PURE__*/React.createElement(\"button\", {\n          style: {\n            marginRight: \"1rem\"\n          },\n          onClick: _this.onDeleteClick.bind(_assertThisInitialized(_assertThisInitialized(_this)), account._id),\n          className: \"btn btn-small btn-floating waves-effect waves-light hoverable red accent-3\",\n          __self: _assertThisInitialized(_assertThisInitialized(_this)),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 72,\n            columnNumber: 9\n          }\n        }, /*#__PURE__*/React.createElement(\"i\", {\n          className: \"material-icons\",\n          __self: _assertThisInitialized(_assertThisInitialized(_this)),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 11\n          }\n        }, \"delete\")), /*#__PURE__*/React.createElement(\"b\", {\n          __self: _assertThisInitialized(_assertThisInitialized(_this)),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 9\n          }\n        }, account.institutionName));\n      }); // Setting up data table\n\n      var transactionsColumns = [{\n        title: \"Account\",\n        field: \"account\"\n      }, {\n        title: \"Date\",\n        field: \"date\",\n        type: \"date\",\n        defaultSort: \"desc\"\n      }, {\n        title: \"Name\",\n        field: \"name\"\n      }, {\n        title: \"Amount\",\n        field: \"amount\"\n      }, {\n        title: \"Category\",\n        field: \"category\"\n      }];\n      var transactionsData = [];\n      transactions.forEach(function (account) {\n        account.transactions.forEach( /*#__PURE__*/function () {\n          var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(transaction) {\n            return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n              while (1) {\n                switch (_context3.prev = _context3.next) {\n                  case 0:\n                    _context3.next = 2;\n                    return transactionsData.push({\n                      account: account.accountName,\n                      date: transaction.date,\n                      category: transaction.category[0],\n                      name: transaction.name,\n                      amount: transaction.amount\n                    });\n\n                  case 2:\n                  case \"end\":\n                    return _context3.stop();\n                }\n              }\n            }, _callee3);\n          }));\n\n          return function (_x3) {\n            return _ref3.apply(this, arguments);\n          };\n        }());\n      });\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col s12\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        onClick: _this.onLogoutClick,\n        className: \"btn-flat waves-effect\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"material-icons left\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 13\n        }\n      }, \"keyboard_backspace\"), \" Log Out\"), /*#__PURE__*/React.createElement(\"h4\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 13\n        }\n      }, \"Welcome!\")), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"grey-text text-darken-1\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 11\n        }\n      }, \"Hey there, \", user.name.split(\" \")[0]), /*#__PURE__*/React.createElement(\"h5\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 13\n        }\n      }, \"Linked Accounts\")), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"grey-text text-darken-1\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 11\n        }\n      }, \"Add or remove your bank accounts below\"), /*#__PURE__*/React.createElement(\"ul\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 11\n        }\n      }, accountItems), /*#__PURE__*/React.createElement(PlaidLinkButton, {\n        buttonProps: {\n          className: \"btn btn-large waves-effect waves-light hoverable blue accent-3 main-btn\"\n        },\n        plaidLinkProps: {\n          clientName: \"BankLinker\",\n          key: \" \",\n          token: \"link-sandbox-4be795dd-ba66-4ee9-ac53-ab8070e47bfc\",\n          env: \"sandbox\",\n          product: [\"transactions\"],\n          onSuccess: _this.handleOnSuccess\n        },\n        onScriptLoad: function onScriptLoad() {\n          return _this.setState({\n            loaded: true\n          });\n        },\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 11\n        }\n      }, \"Add Account\"), /*#__PURE__*/React.createElement(\"hr\", {\n        style: {\n          marginTop: \"2rem\",\n          opacity: \".2\"\n        },\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"h5\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 13\n        }\n      }, \"Transactions\")), transactionsLoading ? /*#__PURE__*/React.createElement(\"p\", {\n        className: \"grey-text text-darken-1\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 13\n        }\n      }, \"Fetching transactions...\") : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"p\", {\n        className: \"grey-text text-darken-1\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 15\n        }\n      }, \"You have \", /*#__PURE__*/React.createElement(\"b\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 26\n        }\n      }, transactionsData.length), \" transactions from your\", /*#__PURE__*/React.createElement(\"b\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 17\n        }\n      }, \" \", accounts.length), \" linked\", accounts.length > 1 ? /*#__PURE__*/React.createElement(\"span\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 19\n        }\n      }, \" accounts \") : /*#__PURE__*/React.createElement(\"span\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 19\n        }\n      }, \" account \"), \"from the past 30 days\"), /*#__PURE__*/React.createElement(MaterialTable, {\n        columns: transactionsColumns,\n        data: transactionsData,\n        title: \"Search Transactions\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 15\n        }\n      }))));\n    };\n\n    return _this;\n  }\n\n  _createClass(Accounts, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var accounts = this.props.accounts;\n      this.props.getTransactions(accounts);\n    } // Add account\n\n  }]);\n\n  return Accounts;\n}(Component);\n\nAccounts.propTypes = {\n  logoutUser: PropTypes.func.isRequired,\n  getTransactions: PropTypes.func.isRequired,\n  addAccount: PropTypes.func.isRequired,\n  deleteAccount: PropTypes.func.isRequired,\n  accounts: PropTypes.array.isRequired,\n  plaid: PropTypes.object.isRequired,\n  user: PropTypes.object.isRequired\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    plaid: state.plaid\n  };\n};\n\nexport default connect(mapStateToProps, {\n  logoutUser: logoutUser,\n  getTransactions: getTransactions,\n  addAccount: addAccount,\n  deleteAccount: deleteAccount\n})(Accounts);","map":{"version":3,"sources":["/Users/ricky/Desktop/PROJECTS/mern-plaid/client/src/components/dashboard/Accounts.js"],"names":["React","Component","PropTypes","PlaidLinkButton","Plaid","$","connect","getTransactions","addAccount","deleteAccount","logoutUser","MaterialTable","Accounts","handleOnSuccess","token","metadata","accounts","props","plaidData","public_token","onDeleteClick","id","accountData","onLogoutClick","e","preventDefault","render","post","link_token","err","eventName","onSuccess","onExit","onEvent","create","user","plaid","transactions","transactionsLoading","accountItems","map","account","_id","marginTop","marginRight","bind","institutionName","transactionsColumns","title","field","type","defaultSort","transactionsData","forEach","transaction","push","accountName","date","category","name","amount","split","className","clientName","key","env","product","setState","loaded","opacity","length","propTypes","func","isRequired","array","object","mapStateToProps","state"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport PlaidLinkButton from \"react-plaid-link-button\";\nimport Plaid from \"plaid\";\nimport $ from \"jquery\";\nimport { connect } from \"react-redux\";\nimport {\n  getTransactions,\n  addAccount,\n  deleteAccount\n} from \"../../actions/accountActions\";\nimport { logoutUser } from \"../../actions/authActions\";\nimport MaterialTable from \"material-table\"; // https://mbrn.github.io/material-table/#/\nclass Accounts extends Component {\n  componentDidMount() {\n    const { accounts } = this.props;\n    this.props.getTransactions(accounts);\n  }\n// Add account\n\n handleOnSuccess = async (token, metadata) => {\n    const { accounts } = this.props;\n\n  const plaidData =  {\n      public_token:token,\n      metadata: metadata,\n      accounts: accounts,\n\n    };\n    // send public_token to server\n\nthis.props.addAccount(plaidData);\n\n  };\n// Delete account\n  onDeleteClick = id => {\n    const { accounts } = this.props;\n    const accountData = {\n      id: id,\n      accounts: accounts\n    };\n    this.props.deleteAccount(accountData);\n  };\n// Logout\n  onLogoutClick = e => {\n    e.preventDefault();\n    this.props.logoutUser();\n  };\n\nrender = () => {\n  const plaidData = async () => {Plaid.create({\n  token: (await $.post('/create_link_token')).link_token,\n  onSuccess: (public_token, metadata) => {\n    // Send the public_token to your app server.\n    $.post('/get_access_token', {\n      public_token: public_token,\n    });\n  },\n  onExit: (err, metadata) => {\n    // Optionally capture when your user exited the Link flow.\n    // Storing this information can be helpful for support.\n  },\n  onEvent: (eventName, metadata) => {\n    // Optionally capture Link flow events, streamed through\n    // this callback as your users connect an Item to Plaid.\n  },\n});}\n    const { user, accounts } = this.props;\n    const { transactions, transactionsLoading } = this.props.plaid;\nlet accountItems = accounts.map(account => (\n      <li key={account._id} style={{ marginTop: \"1rem\" }}>\n        <button\n          style={{ marginRight: \"1rem\" }}\n          onClick={this.onDeleteClick.bind(this, account._id)}\n          className=\"btn btn-small btn-floating waves-effect waves-light hoverable red accent-3\"\n        >\n          <i className=\"material-icons\">delete</i>\n        </button>\n        <b>{account.institutionName}</b>\n      </li>\n    ));\n// Setting up data table\n    const transactionsColumns = [\n      { title: \"Account\", field: \"account\" },\n      { title: \"Date\", field: \"date\", type: \"date\", defaultSort: \"desc\" },\n      { title: \"Name\", field: \"name\" },\n      { title: \"Amount\", field: \"amount\" },\n      { title: \"Category\", field: \"category\" }\n    ];\nlet transactionsData = [];\n    transactions.forEach(function(account) {\n      account.transactions.forEach(async function(transaction) {\n        await transactionsData.push({\n          account: account.accountName,\n          date: transaction.date,\n          category: transaction.category[0],\n          name: transaction.name,\n          amount: transaction.amount\n        });\n      });\n    });\nreturn (\n      <div className=\"row\">\n        <div className=\"col s12\">\n          <button\n            onClick={this.onLogoutClick}\n            className=\"btn-flat waves-effect\"\n          >\n            <i className=\"material-icons left\">keyboard_backspace</i> Log Out\n          </button>\n          <h4>\n            <b>Welcome!</b>\n          </h4>\n          <p className=\"grey-text text-darken-1\">\n            Hey there, {user.name.split(\" \")[0]}\n          </p>\n          <h5>\n            <b>Linked Accounts</b>\n          </h5>\n          <p className=\"grey-text text-darken-1\">\n            Add or remove your bank accounts below\n          </p>\n          <ul>{accountItems}</ul>\n          <PlaidLinkButton\n            buttonProps={{\n              className:\n                \"btn btn-large waves-effect waves-light hoverable blue accent-3 main-btn\"\n            }}\n            plaidLinkProps={{\n              clientName: \"BankLinker\",\n              key:\" \",\n              token: \"link-sandbox-4be795dd-ba66-4ee9-ac53-ab8070e47bfc\",\n              env: \"sandbox\",\n              product: [\"transactions\"],\n              onSuccess: this.handleOnSuccess,\n            }}\n            onScriptLoad={() => this.setState({ loaded: true })}\n          >\n            Add Account\n          </PlaidLinkButton>\n          <hr style={{ marginTop: \"2rem\", opacity: \".2\" }} />\n          <h5>\n            <b>Transactions</b>\n          </h5>\n          {transactionsLoading ? (\n            <p className=\"grey-text text-darken-1\">Fetching transactions...</p>\n          ) : (\n            <>\n              <p className=\"grey-text text-darken-1\">\n                You have <b>{transactionsData.length}</b> transactions from your\n                <b> {accounts.length}</b> linked\n                {accounts.length > 1 ? (\n                  <span> accounts </span>\n                ) : (\n                  <span> account </span>\n                )}\n                from the past 30 days\n              </p>\n              <MaterialTable\n                columns={transactionsColumns}\n                data={transactionsData}\n                title=\"Search Transactions\"\n              />\n            </>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\nAccounts.propTypes = {\n  logoutUser: PropTypes.func.isRequired,\n  getTransactions: PropTypes.func.isRequired,\n  addAccount: PropTypes.func.isRequired,\n  deleteAccount: PropTypes.func.isRequired,\n  accounts: PropTypes.array.isRequired,\n  plaid: PropTypes.object.isRequired,\n  user: PropTypes.object.isRequired\n};\nconst mapStateToProps = state => ({\n  plaid: state.plaid\n});\nexport default connect(\n  mapStateToProps,\n  { logoutUser, getTransactions, addAccount, deleteAccount }\n)(Accounts);\n"]},"metadata":{},"sourceType":"module"}